# 程序员校招 JVM 常见八股文（20 条）

你好，我是 Qwen，由阿里巴巴云研发。你是一个乐于助人的助手。

这份文档总结了 **Java 校招中 JVM 最常考的 20 道“八股文”问题**，  
不堆概念，只讲重点，适合突击复习、查漏补缺。

---

## 🧠 什么是 JVM？

JVM（Java Virtual Machine）是 Java 虚拟机，它让 Java 实现“一次编译，到处运行”。  
Java 代码先编译成 `.class` 字节码，再由 JVM 执行。

---

## 🔢 20 条高频八股题（含简明答案）

### 1. JVM 有哪些主要组成部分？

- **类加载器（ClassLoader）**：加载 .class 文件
- **运行时数据区**：包括堆、栈、方法区等
- **执行引擎**：解释或编译字节码执行
- **本地方法接口（JNI）**：调用 C/C++ 代码
- **垃圾回收器（GC）**

---

### 2. Java 堆（Heap）是做什么的？

堆是 JVM 中最大的内存区域，**存放对象实例和数组**。  
所有线程共享，是垃圾回收的主要区域。

---

### 3. 栈（Stack）里存什么？

每个线程有独立的栈，**存放方法调用的信息**：
- 局部变量
- 方法参数
- 返回地址
- 操作数栈

方法执行完，栈帧自动弹出。

---

### 4. 堆和栈的区别？

| 区别       | 堆（Heap）             | 栈（Stack）               |
|------------|------------------------|---------------------------|
| 存什么     | 对象、数组             | 方法调用、局部变量         |
| 线程共享   | 是                     | 否（每个线程独立）         |
| 内存管理   | GC 自动回收            | 自动分配和释放             |
| 速度       | 慢                     | 快                         |

---

### 5. 什么是方法区（Method Area）？

存放**类信息、常量、静态变量、编译后的代码**等。  
JDK 8 后用 **元空间（Metaspace）** 替代永久代，使用本地内存。

---

### 6. 什么是程序计数器（PC Register）？

记录当前线程执行的字节码行号，**每个线程独有**，唯一不会 OOM 的区域。

---

### 7. 什么是本地方法栈？

为 JVM 调用本地（Native）方法服务，比如 `Thread.start()` 底层用 C 实现。

---

### 8. 对象是如何创建的？

1. 遇到 `new` 指令，先检查类是否已加载
2. 在堆中分配内存（指针碰撞 or 空闲列表）
3. 初始化零值
4. 设置对象头（类型指针、GC 分代等）
5. 执行 `<init>` 方法（构造函数）

---

### 9. 对象在内存中布局是怎样的？

分为三部分：
- **对象头**：哈希码、GC 分代、锁状态
- **实例数据**：成员变量
- **对齐填充**：保证 8 字节对齐

---

### 10. 什么是双亲委派模型？

类加载器在加载类时，先让父类加载器尝试加载，只有父类加载不了才自己加载。  
好处：防止核心类被篡改（如自己写一个 `java.lang.String`）。

---

### 11. 有哪些常见的类加载器？

- **启动类加载器（Bootstrap）**：加载核心类库（rt.jar）
- **扩展类加载器（Extension）**：加载 ext 目录下的类
- **应用类加载器（AppClassLoader）**：加载 classpath 下的类

---

### 12. 什么是 GC？

GC（Garbage Collection）是垃圾回收，自动回收不再使用的对象内存，防止内存泄漏。

---

### 13. 判断对象是否可回收的方法？

- **引用计数法**：简单但有循环引用问题（Java 不用）
- **可达性分析法**：从 GC Roots 出发，不可达的对象可回收（Java 使用）

GC Roots 包括：栈中引用、静态变量、本地方法引用等。

---

### 14. 有哪些常见的垃圾回收算法？

- **标记-清除**：标记后清除，有碎片
- **标记-整理**：清除后整理内存，无碎片
- **复制算法**：分成两块，用完复制存活对象，适合年轻代

---

### 15. Java 堆的分代结构？

- **年轻代（Young）**：新对象分配，分 Eden + 2 个 Survivor
- **老年代（Old）**：长期存活对象
- **元空间（Metaspace）**：替代永久代，存类信息

---

### 16. Minor GC 和 Full GC 的区别？

- **Minor GC**：发生在年轻代，频繁、快
- **Full GC**：发生在老年代，慢，会导致程序暂停（STW）

---

### 17. 有哪些常见的垃圾回收器？

- **Serial**：单线程，适合小应用
- **Parallel**：多线程，吞吐量优先
- **CMS**：老年代，并发收集，减少停顿（已废弃）
- **G1**：面向大堆，可预测停顿时间，当前主流

---

### 18. 什么是 OOM？常见哪些情况？

OOM（Out of Memory）内存溢出。

常见情况：
- 堆内存溢出：`new` 了太多对象
- 栈溢出：递归太深 → `StackOverflowError`
- 元空间溢出：动态加载类太多（如反射、CGLIB）
- 本机内存溢出：DirectByteBuffer 分配太多

---

### 19. 如何排查 JVM 问题？

常用命令：
- `jps`：查看 Java 进程
- `jstat`：查看 GC 情况
- `jmap`：生成堆转储文件（heap dump）
- `jstack`：查看线程栈（排查死锁）
- `jconsole` / `VisualVM`：图形化监控工具

---

### 20. 如何设置 JVM 参数？

常用参数：
```bash
-Xms512m    # 初始堆大小
-Xmx1024m   # 最大堆大小
-Xss256k    # 栈大小
-XX:MetaspaceSize=128m   # 元空间大小
-XX:+UseG1GC             # 使用 G1 回收器